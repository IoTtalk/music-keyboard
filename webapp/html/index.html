<html>
  <head>
     <meta name="viewport" content="width=device-width initial-scale=1.0 maximum-scale=1.0 user-scalable=yes">

    <script src="../js/socket_io.js" type="text/javascript"></script>
    <script src="../js/jquery-2.1.4.js" type="text/javascript"></script>
    <script type="text/javascript" src="../js/Tone.js"></script>
    <script src="../js/semantic.js" type="text/javascript"></script>
    <link href="../css/semantic.css" rel="stylesheet" type="text/css">

  <body>
    <style type="text/css">
      .content{
          margin-left: 100px;
          text-align:center;
          vertical-align: middle;
      }
      #soundBtn{
        margin-top:100px; 
      }
    </style>
    <script>
      var socket = io.connect();
      var dir = '../resources/notes/';
      var room = -1;
      var color = ['#dc143c','#ffa500','#ffd700','#3cb371','#1e90ff','#00bfff','#9932cc'];
      var sound_dir;

      $(document).ready(function() {
        

        $('#soundBtn').hide();
        socket.on("command", function(part) {
            // t = note.replace('#','');
            // sound_dir = dir+t+'.mp3';
            // $('#sound').attr('src',sound_dir);
            // $('#soundBtn').fadeIn('fast');
          var synth = new Tone.Synth().toMaster();
          var pianoPart = new Tone.Part(
          function(time, note){
            synth.triggerAttackRelease(note.noteName,note.duration,time,note.velocity);
          }, part).start(0);
          Tone.Transport.start();
          socket.emit("ack","played");

        });

        $('#soundBtn').click(function(){
          $('#sound')[0].play();
          setTimeout(function(){
            socket.emit("ack","played");
          }, 2000);
          $('#soundBtn').fadeOut('fast');
        });
       $('.item').click(function(){
          $('.item').removeClass('active');
          $(this).addClass('active');

          if(room != -1)
            socket.emit("leave", color[room]);

          $('#soundBtn').hide();

          room = $('.item').index(this)-1;
          socket.emit("join", color[room]);
          $('body').css('background', color[room]);
       });
      });
    </script>

  </head>
  <div class="ui grid">
    <div class="row">
        <div class="ui vertical menu six wide column">
          <div class="header item">ROOM</div>
            <a class="item">
              red
            </a>
            <a class="item">
              orange
            </a>
            <a class="item">
              yellow
            </a>
            <a class="item">
              green
            </a>
            <a class="item">
              blue
            </a>
            <a class="item">
              Indigo
            </a>
            <a class="item">
              purple
            </a>
        </div>

        <div class="content">
            <button id="soundBtn" class="circular ui icon button">
              <i class="massive icon Sound"></i>
              <audio id='sound' preload="auto"></audio>
            </button>
        </div>
      </div>
    </div>
  </body>
</html>