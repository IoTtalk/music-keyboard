<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
	<title>tone demo</title>

	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">

	<script src="../js/socket_io.js" type="text/javascript"></script>

	<script type="text/javascript" src="../js/Tone.js"></script>
    <script src="../js/jquery-2.1.4.js" type="text/javascript"></script>
	<script type="text/javascript">
		var dir = '../resources/notes/';
		$(document).ready(function(){
		// 	var socket = io.connect();
		// 	socket.emit("midi", "");

		// 	socket.on("midi", function(part) {
		// 		i = 0;
		// 		t = part[i++]['noteName'].replace('#','');
		// 		sound_dir = dir+t+'.mp3';
		// 		sound = new Audio(sound_dir);
		// 		sound.addEventListener('ended', function() {
		// 			if(i < part.length){
		// 				t = part[i++]['noteName'].replace('#','');
		// 				sound_dir = dir+t+'.mp3';
		// 				sound = new Audio(sound_dir);
		// 				sound.play();
		// 			}
		// 		}, false);
		// 		sound.play();
		// 	});
		// });			
			

			
			// Tone.Transport.start();

			// // var synth = new Tone.PolySynth(6, Tone.Synth).toMaster();
			// // var synth = new Tone.Synth({
			// // 	"oscillator" : {
			// // 		"type" : "square"
			// // 	},
			// // 	"envelope" : {
			// // 		"attack" : 0.01,
			// // 		"decay" : 0.2,
			// // 		"sustain" : 0.2,
			// // 		"release" : 0.2,
			// // 	}
			// // }).toMaster();
			// // synth.triggerAttackRelease("C4", "8n");
			// // var synth = new Tone.PolySynth(6, Tone.Synth).toMaster();
			// // //set the attributes using the set interface
			// // synth.set("detune", -1200);
			// // //play a chord
			// // synth.triggerAttackRelease(["C4", "E4", "A4"], "4n");

			// //use an array of objects as long as the object has a "time" attribute
			// // var part = new Tone.Part(function(time, value){
			// // 	//the value is an object which contains both the note and the velocity
			// // 	// alert('12')
			// // 	synth.triggerAttackRelease(value.note, "8n", time, value.velocity);
			// // }, [{"time" : 0, "note" : "C3", "velocity": 0.9}, 
			// // 	   {"time" : "0:2", "note" : "C4", "velocity": 0.5}
			// // ]).start(0);


			var socket = io.connect();
			socket.emit("midi", "");
			socket.on("midi", function(part) {
				console.log(part);
				var loop = new Tone.Loop(function(time){

				}, "8n").start(0);
				Tone.Transport.start(0);
				var synth = new Tone.PolySynth(1, Tone.Synth).toMaster();
				var pianoPart = new Tone.Part(
					function(time, note){
						synth.triggerAttackRelease(note.noteName);
					}, part).start(0);
				
			});
				
		});
	</script>
</head>
<body>	

<!-- 	</style>
	synth.triggerAttack(note);


	</style> -->
</body>
</html>